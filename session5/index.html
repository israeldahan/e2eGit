<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div class="wrapper">
        <h2>cart shopping</h2>
        <p></p>
        <ul class="cart">
            <li>Loading Cart...</li>
        </ul>
        <form action="" class="add-items">
            <input type="text" name="item" placeholder="Item Name">
            <input type="submit" value="+ Add Item">
        </form>
        <script>
            const addItems = document.querySelector('.add-items');
            const itemsList = document.querySelector('.cart');
            const items = JSON.parse(localStorage.getItem('items')) || [];
            
            function addItem(e) {
                e.preventDefault();
                const text = (this.querySelector('[name=item]')).value;
                const item = {
                    text,
                    done: false
                }
                items.push(item);
                addToList(items, itemsList)
                localStorage.setItem('items', JSON.stringify(items));

                // console.table(items);
                this.reset();
            }

            function addToList(products = [] , cartList) {
                cartList.innerHTML = products.map((product, i) => {
                    return `
                        <li>
                            <input type="checkbox" data-index=${i} id="item${i}" ${product.done? 'checked' : '' } />
                            <label for=""> ${product.text} </label>
                        </li>
                    `;
                }).join('');
            }

            function toggleDone(e) {
                if(!e.target.matches('input')) return;
                const el = e.target;
                const index = el.dataset.index;
                items[index].done = !items[index].done;
                localStorage.setItem('items', JSON.stringify(items))
                addToList(items, itemsList);
            }
            addItems.addEventListener('submit', addItem);
            itemsList.addEventListener('click', toggleDone)
            // const cb = document.querySelectorAll('input');
            // cb.forEach(input => input.addEventListener('click', () => alert('hi')));
            addToList(items, itemsList)




        </script>
    </div>
</body>
</html>